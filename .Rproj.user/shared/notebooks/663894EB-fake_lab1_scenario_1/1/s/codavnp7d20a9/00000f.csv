"0","model_string <- """
"0","  model {"
"0","    for (i in 1:n_total) {"
"0","      measurement[i] ~ dnorm( mu[i], 1 / sd[i])"
"0","      mu[i] <- a0 + a1[instrument[i]] + a2[operator[i]]"
"0","      sd[i] <- s1[instrument[i]] ^ 2 + s2[operator[i]] ^ 2"
"0","    }"
"0","    "
"0","    a0 ~ dnorm(measurement_mean, 1 / 50)"
"0",""
"0","    #"
"0","    for (j1 in 1:n_instruments) { "
"0","      a1[j1] ~ dnorm(0, 1 / a1sd) "
"0","    }"
"0","    a1sd ~ dgamma(1.05, 0.01)"
"0","    "
"0","    #"
"0","    for (j2 in 1:n_operators) { "
"0","      a2[j2] ~ dnorm(0, 1 / a2sd) "
"0","    }"
"0","    a2sd ~ dgamma(1.05, 0.01)"
"0","    "
"0","    "
"0","    for (j1 in 1:n_instruments) { "
"0","      s1[j1] ~ dgamma(1.05, 0.01) "
"0","    }"
"0","    "
"0","    #"
"0","    for (j2 in 1:n_operators) { "
"0","      s2[j2] ~ dgamma(1.05, 0.01)"
"0","    }"
"0","    "
"0","    "
"0","    #"
"0","    # for (j1 in 1:n_instruments) { for (j2 in 1:n_operators) {"
"0","    # a1a2[j1, j2] ~ dnorm(0, 1/50)"
"0","    # }}"
"0","    ##Sum zero constraints"
"0","    for (j1 in 1:n_instruments) { for (j2 in 1:n_operators) {"
"0","      m[j1, j2] <- a0 + a1[j1] + a2[j2]"
"0","    }}"
"0","    b0 <- mean(m[1:n_instruments, 1:n_operators])"
"0","    for ( j1 in 1:n_instruments ) { b1[j1] <- mean( m[j1,n_operators] ) - b0 }"
"0","    for ( j2 in 1:n_operators ) { b2[j2] <- mean( m[1:n_instruments,j2] ) - b0 }"
"0","}"
"0",""""
"0",""
"0","writeLines(model_string, con = ""core_model_1.txt"")"
